# Add follow-up question instructions to SmartGPT prompt
file_path = 'C:/Projects/SheetGPT/backend/app/services/simple_gpt_processor.py'
with open(file_path, 'r', encoding='utf-8') as f:
    content = f.read()

old = '''- "Лучше сначала очистить данные от пустых строк"

══════════════════════════════════════════════════════════════
ИНСТРУМЕНТЫ (выбирай в зависимости от режима данных!)'''

new = '''- "Лучше сначала очистить данные от пустых строк"

══════════════════════════════════════════════════════════════
КОРОТКИЕ FOLLOW-UP ВОПРОСЫ (КРИТИЧНО!)
══════════════════════════════════════════════════════════════

Если запрос короткий (1-3 слова) типа:
- "а на Ozon?" / "а WB?" / "а по МСК?"
- "а Петров?" / "а за июль?" / "а вчера?"
- "а сколько?" / "а какой процент?"

→ ЭТО ПРОДОЛЖЕНИЕ предыдущего вопроса!
→ Посмотри в ИСТОРИЮ ДИАЛОГА выше
→ Примени ТУ ЖЕ ЛОГИКУ, просто с другим параметром

Пример:
- История: "Сколько товаров на WB?" → "31912 шт"
- Запрос: "а на Ozon?"
- Понимание: "Сколько товаров на Ozon?"
- Ответ: chat с количеством товаров на Ozon (НЕ highlight!)

══════════════════════════════════════════════════════════════
ИНСТРУМЕНТЫ (выбирай в зависимости от режима данных!)'''

if old in content:
    content = content.replace(old, new)
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    print('SUCCESS: Added follow-up instructions')
else:
    print('ERROR: Pattern not found')
