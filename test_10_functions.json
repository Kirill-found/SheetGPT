{
  "test_name": "SheetGPT v7.4.0 - 10 Key Functions Test",
  "description": "Testing 4 base functions + 6 new functions from different categories",
  "test_data": {
    "column_names": ["Продукт", "Менеджер", "Дата", "Продажи", "Регион"],
    "sheet_data": [
      ["Ноутбук", "Иванов", "2024-01-15", 150000, "Москва"],
      ["Телефон", "Петров", "2024-02-20", 80000, "СПб"],
      ["Планшет", "Иванов", "2024-03-10", 45000, "Москва"],
      ["Ноутбук", "Сидоров", "2024-04-05", 160000, "Казань"],
      ["Телефон", "Петров", "2024-05-12", 75000, "СПб"],
      ["Планшет", "Иванов", "2024-06-18", 50000, "Москва"],
      ["Ноутбук", "Сидоров", "2024-07-22", 155000, "Казань"],
      ["Телефон", "Петров", "2024-08-30", 82000, "СПб"],
      ["Планшет", "Иванов", "2024-09-14", 48000, "Москва"],
      ["Ноутбук", "Сидоров", "2024-10-25", 165000, "Казань"]
    ]
  },
  "tests": [
    {
      "id": 1,
      "category": "Base - Highlighting",
      "function": "highlight_rows",
      "query": "выдели желтым строки где продажи больше 100000",
      "expected_function": "highlight_rows",
      "expected_params": {
        "column": "Продажи",
        "operator": ">",
        "value": 100000,
        "color": "yellow"
      },
      "expected_result": {
        "type": "highlight",
        "rows_count": 4,
        "rows": [2, 5, 8, 11]
      }
    },
    {
      "id": 2,
      "category": "Base - Filtering",
      "function": "filter_rows",
      "query": "покажи строки где менеджер Иванов",
      "expected_function": "filter_rows",
      "expected_params": {
        "column": "Менеджер",
        "operator": "==",
        "value": "Иванов"
      },
      "expected_result": {
        "type": "table",
        "rows_count": 4
      }
    },
    {
      "id": 3,
      "category": "Base - Math",
      "function": "calculate_sum",
      "query": "сумма продаж",
      "expected_function": "calculate_sum",
      "expected_params": {
        "column": "Продажи"
      },
      "expected_result": {
        "type": "number",
        "value": 1010000
      }
    },
    {
      "id": 4,
      "category": "Base - Grouping",
      "function": "aggregate_by_group",
      "query": "сумма продаж по менеджерам",
      "expected_function": "aggregate_by_group",
      "expected_params": {
        "group_by": ["Менеджер"],
        "agg_column": "Продажи",
        "agg_func": "sum"
      },
      "expected_result": {
        "type": "table",
        "rows_count": 3
      }
    },
    {
      "id": 5,
      "category": "NEW - Math Operations",
      "function": "calculate_max",
      "query": "максимальная сумма продаж",
      "expected_function": "calculate_max",
      "expected_params": {
        "column": "Продажи"
      },
      "expected_result": {
        "type": "number",
        "value": 165000
      }
    },
    {
      "id": 6,
      "category": "NEW - Filtering Advanced",
      "function": "filter_top_n",
      "query": "топ 3 по продажам",
      "expected_function": "filter_top_n",
      "expected_params": {
        "column": "Продажи",
        "n": 3
      },
      "expected_result": {
        "type": "table",
        "rows_count": 3,
        "top_values": [165000, 160000, 155000]
      }
    },
    {
      "id": 7,
      "category": "NEW - Text Advanced",
      "function": "uppercase",
      "query": "преобразуй продукт в верхний регистр",
      "expected_function": "uppercase",
      "expected_params": {
        "column": "Продукт"
      },
      "expected_result": {
        "type": "table",
        "contains": ["НОУТБУК", "ТЕЛЕФОН", "ПЛАНШЕТ"]
      }
    },
    {
      "id": 8,
      "category": "NEW - Date Advanced",
      "function": "extract_year",
      "query": "извлеки год из даты",
      "expected_function": "extract_year",
      "expected_params": {
        "column": "Дата"
      },
      "expected_result": {
        "type": "table",
        "all_values": 2024
      }
    },
    {
      "id": 9,
      "category": "NEW - Window Functions",
      "function": "moving_average",
      "query": "скользящее среднее продаж за 3 периода",
      "expected_function": "moving_average",
      "expected_params": {
        "column": "Продажи",
        "window": 3
      },
      "expected_result": {
        "type": "table",
        "has_null_first_rows": true
      }
    },
    {
      "id": 10,
      "category": "NEW - Conditional Logic",
      "function": "if_then_else",
      "query": "если продажи больше 100000 то 'Высокие' иначе 'Низкие'",
      "expected_function": "if_then_else",
      "expected_params": {
        "condition_column": "Продажи",
        "operator": ">",
        "threshold": 100000,
        "true_value": "Высокие",
        "false_value": "Низкие"
      },
      "expected_result": {
        "type": "table",
        "contains": ["Высокие", "Низкие"]
      }
    }
  ],
  "notes": [
    "Тест покрывает 7 из 14 категорий функций",
    "4 базовые функции (проверка регрессии)",
    "6 новых функций (проверка новой функциональности)",
    "Все запросы на русском языке (основная аудитория)",
    "Простые тестовые данные: 10 строк, 5 колонок",
    "Ожидаемая точность: 100% (10/10)"
  ]
}
