# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Chrome Extension (–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï)

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

**–ü—Ä–æ–±–ª–µ–º–∞**: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–µ "–í—ã–¥–µ–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: 2", –Ω–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ **–ù–ï –ø—Ä–∏–º–µ–Ω—è–ª–æ –ø–æ–¥—Å–≤–µ—Ç–∫—É** –∫ Google Sheets.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**: –§—É–Ω–∫—Ü–∏—è `displayResult()` —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–æ **–Ω–µ –≤—ã–∑—ã–≤–∞–ª–∞** —Ñ—É–Ω–∫—Ü–∏—é `highlightRows()`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ `highlightRows()` –≤ `displayResult()`.

---

## –®–∞–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
```bash
cd C:\SheetGPT\chrome-extension
git pull origin main
```

### 2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ Chrome

1. –û—Ç–∫—Ä–æ–π—Ç–µ: `chrome://extensions/`
2. –ù–∞–π–¥–∏—Ç–µ **SheetGPT AI Assistant**
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üîÑ Reload** (–æ–±–Ω–æ–≤–∏—Ç—å)

### 3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Google Sheets

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É —Ç–∞–±–ª–∏—Ü—É
2. –ù–∞–∂–º–∏—Ç–µ **F5** –∏–ª–∏ **Ctrl+R** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (—Å–∏–Ω—è—è –∫–Ω–æ–ø–∫–∞ —Å–ø—Ä–∞–≤–∞)
2. –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å: **"–≤—ã–¥–µ–ª–∏ –≥–æ—Ä–æ–¥–∞ —Å –Ω–∞—Å–µ–ª–µ–Ω–∏–µ–º –±–æ–ª—å—à–µ 1,7 –º–ª–Ω"**
3. –ù–∞–∂–º–∏—Ç–µ **Enter**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ Backend –≤–µ—Ä–Ω—ë—Ç: `highlight_rows: [2, 3]`
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–∫–∞–∂–µ—Ç: "‚úÖ –í—ã–¥–µ–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: 2, 3"
- ‚úÖ –í Google Sheets —Å—Ç—Ä–æ–∫–∏ 2-3 –±—É–¥—É—Ç –≤—ã–¥–µ–ª–µ–Ω—ã **–∂—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º**

---

## –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (v6.6.9)

1. ‚úÖ **Backend**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–µ–ª —Å –∑–∞–ø—è—Ç—ã–º–∏ ("12,6" ‚Üí 12.6)
2. ‚úÖ **Backend**: –û–±–Ω–æ–≤–ª—ë–Ω OpenAI –¥–æ 1.109.1 (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å httpx 0.28.1)
3. ‚úÖ **Extension**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ —Å—Ç—Ä–æ–∫ (1-based ‚Üí 0-based)
4. ‚úÖ **Extension**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å –∏–º–ø–æ—Ä—Ç–∞ `sheets-api.js`
5. ‚úÖ **Extension**: –î–æ–±–∞–≤–ª–µ–Ω–æ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ DOM (–±–µ–∑ OAuth timeout)
6. ‚úÖ **Extension**: **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï** - –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `highlightRows()` –≤ `displayResult()`

---

## –ï—Å–ª–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ö–æ–Ω—Å–æ–ª—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (service worker)
1. `chrome://extensions/` ‚Üí **SheetGPT** ‚Üí **"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è: service worker"**
2. –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```
   [Background] Service worker started
   [SheetsAPI] ‚úÖ Got auth token
   ```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ö–æ–Ω—Å–æ–ª—å Google Sheets (F12)
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
   ```javascript
   [SheetGPT] Content script loaded
   [SheetGPT] Reading data from DOM...
   [SheetGPT] ‚úÖ Read from DOM: 10 rows, 2 columns
   [SheetGPT] Applying highlight to rows: [2, 3]
   [SheetGPT] ‚úÖ Rows highlighted
   ```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É "Auth error", –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ service worker:
```javascript
chrome.identity.getAuthToken({ interactive: true }, (token) => {
  console.log('Token:', token ? 'OK' : 'Missing');
});
```

---

## –ö–æ–º–º–∏—Ç—ã

- `74f2b4c` - Fix: Actually call highlightRows() when result contains highlight_rows
- `0accdd8` - Fix: Read sheet data from DOM instead of OAuth API
- `4281b99` - Fix: Correct importScripts path for sheets-api.js
- `9657f1f` - Fix: Correct row index conversion for highlight
- `a97bd23` - Fix: Handle comma decimal separators in numeric comparisons

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Google Sheets
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å—ë –∏–∑ –≤–∫–ª–∞–¥–∫–∏ Console
3. –û—Ç–∫—Ä–æ–π—Ç–µ `chrome://extensions/` ‚Üí SheetGPT ‚Üí "service worker" ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ console
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ–±–∞ –ª–æ–≥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
